<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVG Interactive</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
        }
        #svgContainer {
            width: 100%;
            height: 100%;
            overflow: auto;
            position: relative;
        }
        .clickable { cursor: pointer; }
        .clickable:hover { opacity: 0.8; }
        #svgObject {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: center;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease-out;
        }
    </style>
</head>
<body>
    <div id="svgContainer">
        <object id="svgObject" type="image/svg+xml" data="root.svg" width="100%" height="100%">
            Your browser does not support SVG
        </object>
    </div>

    <script>
        let currentZoom = 1;
        const minZoom = 0.5;  // 50%
        const maxZoom = 3;    // 300%
        const zoomStep = 0.1;

        document.addEventListener('DOMContentLoaded', function() {
            const svgObject = document.getElementById('svgObject');
            const svgContainer = document.getElementById('svgContainer');

            // Zoom handling with mouse wheel
            svgContainer.addEventListener('wheel', function(e) {
                e.preventDefault();
                const delta = e.deltaY > 0 ? -1 : 1;
                let newZoom = currentZoom + (delta * zoomStep);
                newZoom = Math.min(Math.max(newZoom, minZoom), maxZoom);
                
                if (newZoom !== currentZoom) {
                    currentZoom = newZoom;
                    svgObject.style.transform = `translate(-50%, -50%) scale(${currentZoom})`;
                }
            }, { passive: false });
            
            // SVG load and interaction setup
            svgObject.addEventListener('load', function() {
                const svgDoc = svgObject.contentDocument;
                setupInitialVisibility(svgDoc);
                setupButtonListeners(svgDoc);
            });
        });

        function setupInitialVisibility(svgDoc) {
            const groups = Array.from(svgDoc.querySelectorAll('[id^="Group_"]'));
            groups.forEach(group => {
                setGroupVisibility(group, 'hidden');
            });
        }

        function setupButtonListeners(svgDoc) {
            const buttons = Array.from(svgDoc.querySelectorAll('[id^="Button_"]'));
            
            buttons.forEach(button => {
                const buttonId = button.id;
                const groupId = 'Group_' + buttonId.split('Button_')[1];
                const group = svgDoc.getElementById(groupId);

                button.style.cursor = 'pointer';
                button.addEventListener('click', function(e) {
                    e.stopPropagation();
                    if (group) {
                        console.log(`Toggling ${groupId} from button ${buttonId}`);
                        toggleGroupVisibility(group);
                    } else {
                        console.warn(`Group ${groupId} not found for button ${buttonId}`);
                    }
                });
            });
        }

        function setGroupVisibility(group, visibility) {
            if (!group) return;
            group.setAttribute('visibility', visibility);
            Array.from(group.children).forEach(child => {
                if (!child.id || !child.id.startsWith('Group_')) {
                    child.setAttribute('visibility', visibility);
                }
            });
        }

        function toggleGroupVisibility(group) {
            if (!group) return;
            const currentVisibility = group.getAttribute('visibility');
            const newVisibility = (currentVisibility === 'hidden') ? 'visible' : 'hidden';
            setGroupVisibility(group, newVisibility);
            console.log(`Visibility changed to ${newVisibility} for group ${group.id}`);
        }
    </script>
</body>
</html>